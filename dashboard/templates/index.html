<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clopus Watcher</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    }
                }
            }
        }
    </script>
    <style>
        .terminal-scroll::-webkit-scrollbar { width: 8px; }
        .terminal-scroll::-webkit-scrollbar-track { background: #1a1a1a; }
        .terminal-scroll::-webkit-scrollbar-thumb { background: #404040; border-radius: 4px; }
        .terminal-scroll::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body class="bg-neutral-50 text-neutral-900 min-h-screen font-sans">
    <div class="max-w-6xl mx-auto px-6 py-12">
        <!-- Header -->
        <header class="mb-12">
            <div class="flex items-center gap-3 mb-2">
                <div class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></div>
                <h1 class="text-3xl font-bold tracking-tight">Clopus Watcher</h1>
            </div>
            <p class="text-neutral-500 text-sm ml-5">Autonomous Kubernetes Pod Monitor</p>
        </header>

        <!-- Stats -->
        <div class="grid grid-cols-4 gap-6 mb-12">
            <div class="bg-white rounded-lg p-6 shadow-sm border border-neutral-200">
                <div class="text-4xl font-semibold text-neutral-900 mb-1">{{.Total}}</div>
                <div class="text-neutral-400 text-xs uppercase tracking-wider font-medium">Total Events</div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-sm border border-neutral-200">
                <div class="text-4xl font-semibold text-neutral-900 mb-1">{{.Success}}</div>
                <div class="text-emerald-600 text-xs uppercase tracking-wider font-medium">Fixed</div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-sm border border-neutral-200">
                <div class="text-4xl font-semibold text-neutral-900 mb-1">{{.Failed}}</div>
                <div class="text-red-500 text-xs uppercase tracking-wider font-medium">Failed</div>
            </div>
            <div class="bg-white rounded-lg p-6 shadow-sm border border-neutral-200">
                <div class="text-4xl font-semibold text-neutral-900 mb-1">{{.Pending}}</div>
                <div class="text-amber-500 text-xs uppercase tracking-wider font-medium">Pending</div>
            </div>
        </div>

        <!-- Live Terminal -->
        <div class="mb-12">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-sm font-semibold uppercase tracking-wider text-neutral-500">Agent Terminal</h2>
                <div class="flex items-center gap-2 text-xs text-neutral-400">
                    <div class="w-1.5 h-1.5 bg-emerald-500 rounded-full"></div>
                    <span>Live</span>
                </div>
            </div>
            <div class="bg-neutral-900 rounded-xl overflow-hidden shadow-lg border border-neutral-800">
                <div class="flex items-center gap-2 px-4 py-3 bg-neutral-800 border-b border-neutral-700">
                    <div class="w-3 h-3 rounded-full bg-red-500"></div>
                    <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                    <div class="w-3 h-3 rounded-full bg-green-500"></div>
                    <span class="ml-4 text-neutral-400 text-xs font-mono">watcher@clopus ~ claude</span>
                </div>
                <div id="log-container"
                     class="p-4 font-mono text-sm text-neutral-300 h-80 overflow-y-auto terminal-scroll leading-relaxed"
                     hx-get="/logs"
                     hx-trigger="every 2s"
                     hx-swap="innerHTML">
                    {{.Log}}
                </div>
            </div>
        </div>

        <!-- Fixes History -->
        <div>
            <h2 class="text-sm font-semibold uppercase tracking-wider text-neutral-500 mb-4">Fix History</h2>
            <div class="bg-white rounded-xl shadow-sm border border-neutral-200 overflow-hidden">
                <div id="fixes-container" hx-get="/fixes" hx-trigger="every 10s" hx-swap="innerHTML">
                    {{template "fixes-table.html" .}}
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="mt-16 text-center text-neutral-400 text-xs">
            <p>Powered by Claude Code &middot; Watching every 5 minutes</p>
        </footer>
    </div>

    <script>
        const logContainer = document.getElementById('log-container');
        new MutationObserver(() => {
            logContainer.scrollTop = logContainer.scrollHeight;
        }).observe(logContainer, { childList: true });
    </script>
</body>
</html>
